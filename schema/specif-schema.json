{
  "id": "http://specif.de/v0.10.0/schema#",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "JSON-Schema for SpecIF v0.10.0",
  "description": "SpecIF represents the visible, i.e. the diagrams and the text, as well as the semantics of system specifications for model integration and model exchange.",
  "definitions": {
	"id": {
	  "description": "A unique identifier.",
	  "type": "string",
	  "pattern": "^[_a-zA-Z]{1}[_a-zA-Z0-9.-]*$"
	},
	"dateTime": {
	  "description": "An ISO-8601 dateTime string. For reduced accuracy, any number of values may be dropped, but only from right to left.",
	  "type": "string",
	  "pattern": "^(\\d{4}(?!\\d{2}\\b))((-?)((0[1-9]|1[0-2])(\\3([12]\\d|0[1-9]|3[01]))?|W([0-4]\\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\\d|[12]\\d{2}|3([0-5]\\d|6[1-6])))([T\\s]((([01]\\d|2[0-3])((:?)[0-5]\\d)?|24\\:?00)([\\.,]\\d+(?!:))?)?(\\17[0-5]\\d([\\.,]\\d+)?)?([zZ]|([\\+-])([01]\\d|2[0-3]):?([0-5]\\d)?)?)?)?$"
	},
	"icon": {
	  "description": "A symbol for display as a prefix to titles; applicable to the instances of the type where it is defined. Can be any HTML-encoded character or a string with length 1..7 beginning with a certain special character.",
      "type": "string",
	  "pattern": "^(&#[0-9]{1,5};|&#x[0-9]{1,4};|&[a-zA-Z]{1,6};|[@$%#*_\u007B\u20AC\u00A3\u00A5\u00A7]{1,1}[0-9a-zA-Z@$%#*_\u007D\u20AC\u00A3\u00A5\u00A7]{0,6})$"
	},
	"instantiation": {
	  "description": "Indicates whether an instance of the type is created automatically, manually or both. All is allowed, if the property is omitted. The type is abstract and cannot be instantiated, if the property list is present, but empty.",
      "type": "array",
	  "uniqueItems": true,
      "items": {
        "type": "string",
	    "enum": [ "auto", "user" ]
      }
	},
	"revision": {
	  "type": "integer",
	  "minimum": 0
	},
    "nodes": {
      "description": "A list of pointers to resources; may be nested to build a tree, i.e. a hierarchy of pointers.",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/definitions/id"
          },
          "resource": {
            "$ref": "#/definitions/id"
          },
          "revision": {
	    "$ref": "#/definitions/revision"
          },
          "nodes": {
            "$ref": "#/definitions/nodes"
          },
          "changedAt": {
            "$ref": "#/definitions/dateTime"
          }
        },
        "required": [ "id", "resource", "changedAt" ]
      }
    },
    "propertyTypes": {
      "description": "Type definition of a property for resources, statements or hierarchies. Is a sub-element of the respective resourceType, statementType or hierarchyType.",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/definitions/id"
          },
          "title": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "dataType": {
            "$ref": "#/definitions/id"
          },
          "multiple": {
            "type": "boolean",
            "description": "Optional use by a propertyType with dataType 'xs:enumeration'. Indicates whether multiple values can be chosen. If omitted, the 'multiple' property of the dataType applies; by default the value is 'false'."
          },
          "revision": {
            "$ref": "#/definitions/revision"
          },
          "changedAt": {
	    "$ref": "#/definitions/dateTime"
          }
        },
        "required": [ "id", "dataType", "changedAt" ]
      }
    },
    "properties": {
      "description": "A property value for a resource, statement or hierarchy.",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/definitions/id"
          },
          "title": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "propertyType": {
            "$ref": "#/definitions/id"
          },
          "value": {
            "type": "string"
          }
        },
        "required": [ "propertyType", "value" ]
      }
    }
  },
  "type": "object",
  "properties": {
    "id": {
      "$ref": "#/definitions/id"
    },
    "title": {
      "type": "string"
    },
    "description": {
      "type": "string"
    },
    "specifVersion": {
      "type": "string",
	"pattern": "^\\d+(\\.\\d+){1,2}$"
    },
    "generator": {
      "type": "string"
    },
    "generatorVersion": {
      "type": "string"
    },
    "rights": {
      "type": "object",
      "properties": {
        "title": {
          "type": "string"
        },
        "type": {
          "type": "string"
        },
        "url": {
          "type": "string"
        }
      },
      "required": [ "title", "type", "url" ]
    },
    "createdAt": {
	  "$ref": "#/definitions/dateTime"
    },
    "createdBy": {
      "description": "The creator of the SpecIF structure (file). If specified, at least an e-mail address must be given.",
      "type": "object",
      "properties": {
        "familyName": {
          "type": "string"
        },
        "givenName": {
          "type": "string"
        },
        "org": {
          "type": "object",
          "properties": {
            "organizationName": {
              "type": "string"
            }
          },
          "required": [ "organizationName" ]
        },
        "email": {
          "type": "object",
          "properties": {
            "type": {
              "type": "string"
            },
            "value": {
              "type": "string",
	          "format": "email"
            }
          },
          "required": [ "value" ]
        }
      },
      "required": [ "email" ]
    },
    "dataTypes": {
      "description": "The base data types for use by property type definitions.",
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/definitions/id"
          },
          "title": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "type": {
            "type": "string",
            "title": "Data Type",
            "description": "The corresponding definitions in https://www.w3.org/TR/xmlschema-2/ and https://www.w3.org/TR/xhtml1/ apply.",
            "enum": [ "xs:boolean", "xs:integer", "xs:double", "xs:dateTime", "xs:string", "xhtml", "xs:enumeration" ]
          },
          "maxLength":  {
            "type": "integer",
            "title": "Maximum String Length",
            "description": "Optional use by dataTypes 'xs:string' and 'XHTML'.",
            "minimum": 0
          },
          "accuracy": {
	    "type": "integer",
            "title": "Accuracy of a Decimal Number",
            "description": "Optional use by dataType 'xs:double', indicates the number of decimals.",
            "minimum": 1
	  },
          "min":  {
            "type": "number",
            "title": "Minimum Value of a Number",
            "description": "Optional use by dataTypes 'xs:integer' and 'xs:double'."
          },
          "max":  {
            "type": "number",
            "title": "Maximum Value of a Number",
             "description": "Optional use by dataTypes 'xs:integer' and 'xs:double'."
          },
          "values": {
            "type": "array",
            "title": "Enumerated Values",
            "description": "Mandatory use by dataType 'xs:enumeration'. If 'multiple' is true 0..n options may be selected, otherwise exactly one must be selected.",
            "items": {
              "type": "object",
              "properties": {
                "id": {
                  "$ref": "#/definitions/id"
                },
                "title": {
                  "type": "string"
                }
              },
              "required": [ "id", "title" ]
            }
          },
          "multiple": {
            "type": "boolean",
            "description": "Optional use by dataType 'xs:enumeration'. Indicates whether multiple values can be chosen; by default the value is 'false'."
          },
          "revision": {
            "$ref": "#/definitions/revision"
          },
          "changedAt": {
            "$ref": "#/definitions/dateTime"
          },
          "changedBy": {
            "type": "string"
          }
	},
        "additionalProperties": false,
        "required": [ "id", "title", "type", "changedAt" ]
      }
    },
    "resourceTypes": {
      "description": "The type definitions for resources.",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/definitions/id"
          },
          "title": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "icon": {
            "$ref": "#/definitions/icon"
          },
          "isHeading": {
            "type": "boolean"
          },
          "instantiation": {
            "$ref": "#/definitions/instantiation"
          },
          "propertyTypes": {
            "$ref": "#/definitions/propertyTypes"
          },
          "revision": {
	        "$ref": "#/definitions/revision"
          },
          "changedAt": {
	        "$ref": "#/definitions/dateTime"
          },
          "changedBy": {
            "type": "string"
          }
        },
        "required": [ "id", "title", "propertyTypes", "changedAt" ]
      }
    },
    "statementTypes": {
      "description": "The type definitions for statements in subject-predicate-object statements, where subject and object are resources.",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/definitions/id"
          },
          "title": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "icon": {
            "$ref": "#/definitions/icon"
          },
          "instantiation": {
            "$ref": "#/definitions/instantiation"
          },
          "subjectTypes": {
            "type": "array",
			"title": "Eligible Subject Types",
			"description": "A collection of type id's of eligible resource types; if missing, all resource types are eligible",
			"minItems": 1,
			"uniqueItems": true,
            "items": {
              "$ref": "#/definitions/id"
            }
          },
          "objectTypes": {
            "type": "array",
			"title": "Eligible Object Types",
			"description": "A collection of type id's of eligible resource types; if missing, all resource types are eligible",
			"minItems": 1,
			"uniqueItems": true,
            "items": {
              "$ref": "#/definitions/id"
            }
          },
          "propertyTypes": {
            "$ref": "#/definitions/propertyTypes"
          },
          "revision": {
	        "$ref": "#/definitions/revision"
          },
          "changedAt": {
	        "$ref": "#/definitions/dateTime"
          },
          "changedBy": {
            "type": "string"
          }
        },
        "required": [ "id", "title", "changedAt" ]
      }
    },
    "hierarchyTypes": {
      "description": "The type definitions for hierarchy roots.",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/definitions/id"
          },
          "title": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "icon": {
            "$ref": "#/definitions/icon"
          },
          "instantiation": {
            "$ref": "#/definitions/instantiation"
          },
          "propertyTypes": {
            "$ref": "#/definitions/propertyTypes"
          },
          "revision": {
			"$ref": "#/definitions/revision"
          },
          "changedAt": {
			"$ref": "#/definitions/dateTime"
          },
          "changedBy": {
            "type": "string"
          }
        },
        "required": [ "id", "title", "changedAt" ]
      }
    },
    "resources": {
      "description": "The resources such as diagrams, model elements or requirements.",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/definitions/id"
          },
          "title": {
            "type": "string"
          },
          "resourceType": {
            "$ref": "#/definitions/id"
          },
          "properties": {
            "$ref": "#/definitions/properties"
          },
          "revision": {
			"$ref": "#/definitions/revision"
          },
          "changedAt": {
			"$ref": "#/definitions/dateTime"
          },
          "changedBy": {
            "type": "string"
          }
        },
        "required": [ "id", "title", "resourceType", "properties", "changedAt" ]
      }
    },
    "statements": {
      "description": "Subject-predicate-Object statements, where subject and object are resources. In other terms, statements are relations between two resources building a semantic net.",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/definitions/id"
          },
          "title": {
            "type": "string"
          },
          "statementType": {
            "$ref": "#/definitions/id"
          },
          "subject": {
            "type": "object",
            "properties": {
              "id": {
				"$ref": "#/definitions/id"
              },
              "revision": {
				"$ref": "#/definitions/revision"
              }
            },
            "required": [ "id" ]
          },
          "object": {
            "type": "object",
            "properties": {
              "id": {
				"$ref": "#/definitions/id"
              },
              "revision": {
				"$ref": "#/definitions/revision"
              }
            },
            "required": [ "id" ]
          },
          "properties": {
            "$ref": "#/definitions/properties"
          },
          "revision": {
            "$ref": "#/definitions/revision"
          },
          "changedAt": {
            "$ref": "#/definitions/dateTime"
          },
          "changedBy": {
            "type": "string"
          }
        },
        "required": [ "id", "title", "statementType", "subject", "object", "changedAt" ]
      }
    },
    "hierarchies": {
      "description": "Hierarchy trees, each referencing resources to constitute an outline, bill-of-material or similar.",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/definitions/id"
          },
          "title": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "hierarchyType": {
            "$ref": "#/definitions/id"
          },
          "properties": {
            "$ref": "#/definitions/properties"
          },
          "nodes": {
			"$ref": "#/definitions/nodes"
          },
          "revision": {
			"$ref": "#/definitions/revision"
          },
          "changedAt": {
			"$ref": "#/definitions/dateTime"
          },
          "changedBy": {
            "type": "string"
          }
        },
        "required": [ "id", "title", "hierarchyType", "nodes", "changedAt" ]
      }
    },
    "files": {
      "type": "array",
      "items": {}
    }
  },
  "required": [ 
    "id",
    "title",
    "specifVersion",
    "dataTypes",
    "resourceTypes",
    "statementTypes",
    "hierarchyTypes",
    "resources",
    "statements",
    "hierarchies"
  ]
}
