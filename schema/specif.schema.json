{
  "id": "http://specif.de/v0.11.1/schema#",
  "$schema": "http://json-schema.org/draft-04/schema#",
  "title": "JSON-Schema for SpecIF v0.11.1",
  "description": "SpecIF represents the visible, i.e. the diagrams and the text, as well as the semantics of system specifications for model integration and model exchange.",
  "definitions": {
	"id": {
	  "description": "A unique identifier.",
	  "type": "string",
	  "pattern": "^[_a-zA-Z]{1}[_a-zA-Z0-9.-]*$"
	},
	"revision": {
	  "description": "Every update gets an incremented revision number; if items have the same revision number, they have been changed in a common transaction.",
	  "type": "integer",
	  "minimum": 0
	},
	"key": {
	  "description": "A unique key for a particular revision of an identifiable item, e.g. of a resource.",
	  "oneOf": [{
		"description": "A string with a valid identifier; where the last revision (i.e. revision=0) is implied.",
        "$ref": "#/definitions/id"
	  }, {
		"description": "A key consisting of a valid identifier and a revision. Revision=0 means the latest revision of the identified item. If the revision does not exist, the next lower existing revision applies.",
		"type": "object",
		"properties": {
		  "id": {
			"$ref": "#/definitions/id"
		  },
		  "revision": {
			"$ref": "#/definitions/revision"
		  }
		},
		"required": [ "id" ]
	  }]
	},
    "dateTime": {
      "description": "An ISO-8601 dateTime string. For reduced accuracy, any number of values may be dropped, but only from right to left.",
      "type": "string",
      "pattern": "^(\\d{4}(?!\\d{2}\\b))((-?)((0[1-9]|1[0-2])(\\3([12]\\d|0[1-9]|3[01]))?|W([0-4]\\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\\d|[12]\\d{2}|3([0-5]\\d|6[1-6])))([T\\s]((([01]\\d|2[0-3])((:?)[0-5]\\d)?|24\\:?00)([\\.,]\\d+(?!:))?)?(\\17[0-5]\\d([\\.,]\\d+)?)?([zZ]|([\\+-])([01]\\d|2[0-3]):?([0-5]\\d)?)?)?)?$"
    },
    "icon": {
      "description": "A symbol for display as a prefix to titles; applicable to the instances of the type where it is defined. Can be any HTML-encoded character or a string with length 1..7 beginning with a certain special character or an empty string.",
      "type": "string",
      "pattern": "^(|&#[0-9]{1,5};|&#x[0-9]{1,4};|&[a-zA-Z]{1,6};|[@$%#*_\u007B\u20AC\u00A3\u00A5\u00A7]{1,1}[0-9a-zA-Z@$%#*_\u007D\u20AC\u00A3\u00A5\u00A7]{0,6})$"
    },
    "instantiation": {
      "description": "Indicates whether an instance of the type is created automatically, manually or both. All is allowed, if the property is omitted. The type is abstract and cannot be instantiated, if the property list is present, but empty.",
      "type": "array",
      "uniqueItems": true,
      "items": {
        "type": "string",
        "enum": [ "auto", "user" ]
      }
    },
    "value": {
      "description": "A property value according to the property type.",
      "oneOf": [{
        "description": "A string containing some text or a special value.",
        "type": "string"
      }, {
        "description": "A list of items with text and language properties. Thus, the information can be given in multiple languages.",
        "type": "array",
        "items": {
            "type": "object",
            "properties": {
              "text": {
                "description": "A string containing some text.",
                "type": "string"
              },
              "language": {
                "description": "An IETF language tag such as 'en', 'en-US, 'fr' or 'de'.",
                "type": "string"
              }
            },
            "additionalProperties": false,
            "required": [ "text", "language" ]
        }		
      }]
    },
    "nodes": {
      "description": "A list of pointers to resources; may be nested to build a tree, i.e. a hierarchy of pointers.",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/definitions/id"
          },
          "resource": {
            "description": "The pointer to the resource to be displayed at this position.",
            "$ref": "#/definitions/key"
          },
          "nodes": {
            "description": "The next level of the hierarchy.",
            "$ref": "#/definitions/nodes"
          },
          "revision": {
            "$ref": "#/definitions/revision"
          },
          "changedAt": {
            "$ref": "#/definitions/dateTime"
          }
        },
        "required": [ "id", "resource" ]
      }
    },
    "propertyTypes": {
      "description": "Type definition of a property for resources, statements or hierarchies. Is a sub-element of the respective resourceType, statementType or hierarchyType. If no revision or change information is specified, the respective values of the parent element apply.",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/definitions/id"
          },
          "title": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "dataType": {
            "$ref": "#/definitions/key"
          },
          "multiple": {
            "type": "boolean",
            "description": "Optional use by a propertyType with dataType 'xs:enumeration'. Indicates whether multiple values can be chosen. If omitted, the 'multiple' property of the dataType applies; by default the value is 'false'."
          },
          "revision": {
            "$ref": "#/definitions/revision"
          },
          "changedAt": {
            "$ref": "#/definitions/dateTime"
          }
        },
        "required": [ "id", "dataType" ]
      }
    },
    "properties": {
      "description": "A property value for a resource, statement or hierarchy.",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/definitions/id"
          },
          "title": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "propertyType": {
            "$ref": "#/definitions/key"
          },
          "value": {
            "$ref": "#/definitions/value"
          },
          "revision": {
            "$ref": "#/definitions/revision"
          },
          "changedAt": {
            "$ref": "#/definitions/dateTime"
          }
        },
        "required": [ "propertyType", "value" ]
      }
    }
  },
  "type": "object",
  "properties": {
    "id": {
      "$ref": "#/definitions/id"
    },
    "title": {
      "type": "string"
    },
    "description": {
      "type": "string"
    },
    "specifVersion": {
      "type": "string",
      "pattern": "^\\d+(\\.\\d+){1,2}$"
    },
    "generator": {
      "type": "string"
    },
    "generatorVersion": {
      "type": "string"
    },
    "rights": {
      "type": "object",
      "properties": {
        "title": {
          "type": "string"
        },
        "type": {
          "type": "string"
        },
        "url": {
          "type": "string"
        }
      },
      "required": [ "title", "type", "url" ]
    },
    "createdAt": {
      "$ref": "#/definitions/dateTime"
    },
    "createdBy": {
      "description": "The creator of the SpecIF structure (file). If specified, at least an e-mail address must be given.",
      "type": "object",
      "properties": {
        "familyName": {
          "type": "string"
        },
        "givenName": {
          "type": "string"
        },
        "org": {
          "type": "object",
          "properties": {
            "organizationName": {
              "type": "string"
            }
          },
          "required": [ "organizationName" ]
        },
        "email": {
          "type": "object",
          "properties": {
            "type": {
              "type": "string"
            },
            "value": {
              "type": "string",
              "format": "email"
            }
          },
          "required": [ "value" ]
        }
      },
      "required": [ "email" ]
    },
    "dataTypes": {
      "description": "The base data types for use by property type definitions.",
      "type": "array",
      "minItems": 1,
      "items": {
        "oneOf": [{
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "title": "Data-type 'Boolean'",
              "description": "The corresponding definition in https://www.w3.org/TR/xmlschema-2/ applies.",
              "enum": [ "xs:boolean", "xs:dateTime" ]
            },
            "id": {
              "$ref": "#/definitions/id"
            },
            "title": {
              "type": "string"
            },
            "description": {
              "type": "string"
            },
            "revision": {
              "$ref": "#/definitions/revision"
            },
            "changedAt": {
              "$ref": "#/definitions/dateTime"
            },
            "changedBy": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "required": [ "id", "title", "type", "changedAt" ]
        }, {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "title": "Data-type 'Integer'",
              "description": "The corresponding definition in https://www.w3.org/TR/xmlschema-2/ applies.",
              "enum": [ "xs:integer" ]
            },
            "id": {
              "$ref": "#/definitions/id"
            },
            "title": {
              "type": "string"
            },
            "description": {
              "type": "string"
            },
            "min":  {
              "type": "number",
              "title": "Minimum Value of a Number",
              "description": "Optional use by dataTypes 'xs:integer' and 'xs:double'."
            },
            "max":  {
              "type": "number",
              "title": "Maximum Value of a Number",
              "description": "Optional use by dataTypes 'xs:integer' and 'xs:double'."
            },
            "revision": {
              "$ref": "#/definitions/revision"
            },
            "changedAt": {
              "$ref": "#/definitions/dateTime"
            },
            "changedBy": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "required": [ "id", "title", "type", "changedAt" ]
        }, {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "title": "Data-type 'Double'",
              "description": "The corresponding definition in https://www.w3.org/TR/xmlschema-2/ applies.",
              "enum": [ "xs:double" ]
            },
            "id": {
              "$ref": "#/definitions/id"
            },
            "title": {
              "type": "string"
            },
            "description": {
              "type": "string"
            },
            "accuracy": {
              "type": "integer",
              "title": "Accuracy of a Decimal Number",
              "description": "Optional use by dataType 'xs:double', indicates the number of decimals.",
              "minimum": 1
            },
            "min":  {
              "type": "number",
              "title": "Minimum Value of a Number",
              "description": "Optional use by dataTypes 'xs:integer' and 'xs:double'."
            },
            "max":  {
              "type": "number",
              "title": "Maximum Value of a Number",
              "description": "Optional use by dataTypes 'xs:integer' and 'xs:double'."
            },
            "revision": {
              "$ref": "#/definitions/revision"
            },
            "changedAt": {
              "$ref": "#/definitions/dateTime"
            },
            "changedBy": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "required": [ "id", "title", "type", "changedAt" ]
        }, {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "title": "Data-type",
              "description": "The corresponding definition in https://www.w3.org/TR/xmlschema-2/ resp. https://www.w3.org/TR/xhtml1/ applies.",
              "enum": [ "xs:string", "xhtml" ]
            },
            "id": {
              "$ref": "#/definitions/id"
            },
            "title": {
              "type": "string"
            },
            "description": {
              "type": "string"
            },
            "maxLength":  {
              "type": "integer",
              "title": "Maximum String Length",
              "description": "Optional use by dataTypes 'xs:string' and 'XHTML'.",
              "minimum": 0
            },
            "revision": {
              "$ref": "#/definitions/revision"
            },
            "changedAt": {
              "$ref": "#/definitions/dateTime"
            },
            "changedBy": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "required": [ "id", "title", "type", "changedAt" ]
        }, {
          "type": "object",
          "properties": {
            "type": {
              "type": "string",
              "title": "Data-type",
              "description": "The corresponding definition in https://www.w3.org/TR/xmlschema-2/ applies.",
              "enum": [ "xs:enumeration" ]
            },
            "id": {
              "$ref": "#/definitions/id"
            },
            "title": {
              "type": "string"
            },
            "description": {
              "type": "string"
            },
            "values": {
              "type": "array",
              "title": "Enumerated Values",
              "description": "Mandatory use by dataType 'xs:enumeration'. If 'multiple' is true 0..n options may be selected, otherwise exactly one must be selected.",
              "items": {
                "type": "object",
                "properties": {
                  "id": {
                    "$ref": "#/definitions/id"
                  },
                  "title": {
                    "type": "string"
                  }
                },
                "required": [ "id", "title" ]
              }
            },
            "multiple": {
              "type": "boolean",
              "description": "Optional use by dataType 'xs:enumeration'. Indicates whether multiple values can be chosen; by default the value is 'false'."
            },
            "revision": {
              "$ref": "#/definitions/revision"
            },
            "changedAt": {
              "$ref": "#/definitions/dateTime"
            },
            "changedBy": {
              "type": "string"
            }
          },
          "additionalProperties": false,
          "required": [ "id", "title", "type", "values", "changedAt" ]
        }]	
      }
    },
    "resourceTypes": {
      "description": "The type definitions for resources.",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/definitions/id"
          },
          "title": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "icon": {
            "$ref": "#/definitions/icon"
          },
          "isHeading": {
            "type": "boolean"
          },
          "instantiation": {
            "$ref": "#/definitions/instantiation"
          },
          "propertyTypes": {
            "$ref": "#/definitions/propertyTypes"
          },
          "revision": {
            "$ref": "#/definitions/revision"
          },
          "changedAt": {
	        "$ref": "#/definitions/dateTime"
          },
          "changedBy": {
            "type": "string"
          }
        },
        "required": [ "id", "title", "propertyTypes", "changedAt" ]
      }
    },
    "statementTypes": {
      "description": "The type definitions for statements in subject-predicate-object statements, where subject and object are resources.",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/definitions/id"
          },
          "title": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "icon": {
            "$ref": "#/definitions/icon"
          },
          "instantiation": {
            "$ref": "#/definitions/instantiation"
          },
          "subjectTypes": {
            "type": "array",
            "title": "Eligible Subject Types",
            "description": "A collection of type id's of eligible resource types; if missing, all resource types are eligible",
            "minItems": 1,
            "uniqueItems": true,
            "items": {
              "$ref": "#/definitions/key"
            }
          },
          "objectTypes": {
            "type": "array",
            "title": "Eligible Object Types",
            "description": "A collection of type id's of eligible resource types; if missing, all resource types are eligible",
            "minItems": 1,
            "uniqueItems": true,
            "items": {
              "$ref": "#/definitions/key"
            }
          },
          "propertyTypes": {
            "$ref": "#/definitions/propertyTypes"
          },
          "revision": {
            "$ref": "#/definitions/revision"
          },
          "changedAt": {
            "$ref": "#/definitions/dateTime"
          },
          "changedBy": {
            "type": "string"
          }
        },
        "required": [ "id", "title", "changedAt" ]
      }
    },
    "hierarchyTypes": {
      "description": "The type definitions for hierarchy roots.",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/definitions/id"
          },
          "title": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "icon": {
            "$ref": "#/definitions/icon"
          },
          "instantiation": {
            "$ref": "#/definitions/instantiation"
          },
          "propertyTypes": {
            "$ref": "#/definitions/propertyTypes"
          },
          "revision": {
			"$ref": "#/definitions/revision"
          },
          "changedAt": {
            "$ref": "#/definitions/dateTime"
          },
          "changedBy": {
            "type": "string"
          }
        },
        "required": [ "id", "title", "changedAt" ]
      }
    },
    "resources": {
      "description": "The resources such as diagrams, model elements or requirements.",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/definitions/id"
          },
          "title": {
            "type": "string"
          },
          "resourceType": {
            "$ref": "#/definitions/key"
          },
          "properties": {
            "$ref": "#/definitions/properties"
          },
          "revision": {
            "$ref": "#/definitions/revision"
          },
          "changedAt": {
            "$ref": "#/definitions/dateTime"
          },
          "changedBy": {
            "type": "string"
          }
        },
        "required": [ "id", "title", "resourceType", "properties", "changedAt" ]
      }
    },
    "statements": {
      "description": "Subject-predicate-Object statements, where subject and object are resources. In other terms, statements are relations between two resources building a semantic net.",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/definitions/id"
          },
          "title": {
            "type": "string"
          },
          "statementType": {
            "$ref": "#/definitions/key"
          },
          "subject": {
            "$ref": "#/definitions/key"
          },
          "object": {
            "$ref": "#/definitions/key"
          },
          "properties": {
            "$ref": "#/definitions/properties"
          },
          "revision": {
            "$ref": "#/definitions/revision"
          },
          "changedAt": {
            "$ref": "#/definitions/dateTime"
          },
          "changedBy": {
            "type": "string"
          }
        },
        "required": [ "id", "title", "statementType", "subject", "object", "changedAt" ]
      }
    },
    "hierarchies": {
      "description": "Hierarchy trees, each referencing resources to constitute an outline, bill-of-material or similar.",
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "$ref": "#/definitions/id"
          },
          "title": {
            "type": "string"
          },
          "description": {
            "type": "string"
          },
          "hierarchyType": {
            "$ref": "#/definitions/key"
          },
          "properties": {
            "$ref": "#/definitions/properties"
          },
          "nodes": {
            "$ref": "#/definitions/nodes"
          },
          "revision": {
            "$ref": "#/definitions/revision"
          },
          "changedAt": {
            "$ref": "#/definitions/dateTime"
          },
          "changedBy": {
            "type": "string"
          }
        },
        "required": [ "id", "title", "hierarchyType", "nodes", "changedAt" ]
      }
    },
    "files": {
      "type": "array",
      "items": {}
    }
  },
  "required": [ 
    "id",
    "title",
    "specifVersion",
    "dataTypes",
    "resourceTypes",
    "statementTypes",
    "hierarchyTypes",
    "resources",
    "statements",
    "hierarchies"
  ]
}
